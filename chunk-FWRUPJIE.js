import{$b as T,Ac as B,Bc as G,Ea as E,F as w,Fa as s,Ga as M,Ha as k,Hc as A,Ic as H,J as g,K as _,Kc as z,Nc as Q,Oa as L,Pc as $,Qc as x,Sc as K,Tc as W,V as m,W as c,Wc as X,Xa as O,Xc as Y,Yc as Z,_c as ee,bc as V,bd as te,ca as d,cd as re,da as b,ea as l,na as o,oa as a,pa as h,qc as j,sc as F,ta as S,tc as D,ua as v,va as f,vc as R,wc as U,xb as N,xc as q,y as I,yb as P,zc as J}from"./chunk-HAWMPXUI.js";import{e as y}from"./chunk-BNZU7Q4F.js";var ie=(()=>{let r=class r{setUser(t){this.user=t,this.saveStorage()}resetUser(){this.user={password:"",companyId:"",username:"",desdeMs:!0,token:""},this.saveStorage()}constructor(){this.user={password:"",companyId:"",username:"",desdeMs:!0,token:""},this.readStorage()}saveStorage(){sessionStorage.setItem("user",JSON.stringify(this.user))}readStorage(){if(sessionStorage.getItem("user")){let t=sessionStorage.getItem("user");this.user=JSON.parse(JSON.stringify(t))}}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=I({token:r,factory:r.\u0275fac,providedIn:"root"});let e=r;return e})();function ae(e,r){e&1&&(o(0,"mat-error"),s(1,"Por favor ingresar un correo v\xE1lido"),a())}function se(e,r){e&1&&(o(0,"mat-error"),s(1," Correo es "),o(2,"strong"),s(3,"requerido"),a()())}function me(e,r){e&1&&(o(0,"mat-error"),s(1," Clave es "),o(2,"strong"),s(3,"requerido"),a()())}function le(e,r){if(e&1&&(o(0,"div",18),s(1),a()),e&2){let n=f(2);m(),k(" ",n.messageError," ")}}function ce(e,r){if(e&1){let n=S();o(0,"mat-card-content")(1,"form",8)(2,"div",9)(3,"div",10)(4,"mat-form-field",11)(5,"mat-label"),s(6,"Usuario (Correo)"),a(),h(7,"input",12),d(8,ae,2,0,"mat-error",13)(9,se,4,0,"mat-error",13),a()(),o(10,"div",10)(11,"mat-form-field",14)(12,"mat-label"),s(13,"Password"),a(),o(14,"input",15),v("keyup.enter",function(){g(n);let i=f();return _(i.verificarDatos())}),a(),d(15,me,4,0,"mat-error",13),o(16,"button",16),v("click",function(){g(n);let i=f();return _(i.hide=!i.hide)}),o(17,"mat-icon"),s(18),a()()()()()(),d(19,le,2,1,"div",17),a()}if(e&2){let n=f();m(),l("formGroup",n.formulario),m(7),l("ngIf",n.username==null?null:n.username.hasError("email")),m(),l("ngIf",n.username==null?null:n.username.hasError("required")),m(5),l("type",n.hide?"password":"text"),m(),l("ngIf",n.password==null?null:n.password.hasError("required")),m(),b("aria-label","Hide password")("aria-pressed",n.hide),m(2),M(n.hide?"visibility_off":"visibility"),m(),l("ngIf",n.error)}}function de(e,r){e&1&&h(0,"app-loading-spinner")}var we=(()=>{let r=class r{get username(){let t=this.formulario.get("username");return t!==null?t:null}get password(){let t=this.formulario.get("password");return t!==null?t:null}constructor(t,i,p,u,C){this.userRegisterService=t,this.router=i,this.formBuilder=p,this.sesionService=u,this.errorService=C,this.hide=!0,this.isLoading=!0,this.error=!1,this.formulario=this.formBuilder.group({username:["",[x.required,x.email]],password:["",x.required]})}ngOnInit(){return y(this,null,function*(){(yield this.userRegisterService.supabase.auth.getUser()).data.user&&this.router.navigate(["/home"])})}verificarDatos(){this.error=!1,this.isLoading=!1,this.userRegisterService.login(this.username.value,this.password.value).subscribe({next:t=>{let i=JSON.parse(JSON.stringify(t));this.error=!1,this.sesionService.setUser(i),this.isLoading=!0,this.router.navigate(["/home"])},error:t=>{let i=JSON.parse(JSON.stringify(t));this.isLoading=!0,this.sesionService.resetUser(),this.error=!0,this.messageError=`Error: ${i.message}`,this.errorService.showMessage(this.messageError)},complete:()=>{}})}};r.\u0275fac=function(i){return new(i||r)(c(te),c(N),c(ee),c(ie),c(j))},r.\u0275cmp=w({type:r,selectors:[["app-login"]],decls:17,vars:3,consts:[["content",""],[1,"fondo"],[1,"example-card"],[4,"ngIf","ngIfElse"],["mat-raised-button","","color","primary",3,"click","disabled"],[1,"my-2"],[1,"centered-footer"],["routerLink","/register"],[1,"example-form",3,"formGroup"],[1,"row"],[1,"col-md-12"],[1,"example-full-width"],["matInput","","formControlName","username","type","email","placeholder","Ex. pat@example.com"],[4,"ngIf"],["appearance","fill",1,"example-full-width"],["formControlName","password","matInput","",3,"keyup.enter","type"],["mat-icon-button","","matSuffix","",3,"click"],["class","alert alert-danger","role","alert",4,"ngIf"],["role","alert",1,"alert","alert-danger"]],template:function(i,p){if(i&1){let u=S();o(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-card-title"),s(4,"Ingresar"),a()(),d(5,ce,20,9,"mat-card-content",3),o(6,"mat-card-actions")(7,"button",4),v("click",function(){return g(u),_(p.verificarDatos())}),s(8," Ingresar "),a()(),h(9,"hr",5),o(10,"mat-card-footer",6)(11,"p"),s(12,"\xBFNo tiene sesi\xF3n? "),o(13,"a",7),s(14,"Reg\xEDstrese aqu\xED"),a()()()()(),d(15,de,1,0,"ng-template",null,0,L)}if(i&2){let u=E(16);m(5),l("ngIf",p.isLoading)("ngIfElse",u),m(2),l("disabled",p.formulario.invalid)}},dependencies:[O,F,P,D,R,J,q,G,B,U,T,V,re,Q,A,H,z,X,$,K,W,Y,Z],styles:['.example-form[_ngcontent-%COMP%]{min-width:150px;max-width:500px;width:100%}.example-full-width[_ngcontent-%COMP%]{padding-top:.3rem;width:100%}.td-name[_ngcontent-%COMP%]{padding-right:8px}input[_ngcontent-%COMP%]{color:#fff}.example-card[_ngcontent-%COMP%]{min-width:425px;margin:0 auto}mat-card-actions[_ngcontent-%COMP%]{margin-left:auto}.error-login[_ngcontent-%COMP%]{margin-top:20px;position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem;color:#721c24;background-color:#f8d7da;border-color:#f5c6cb}.mat-card[_ngcontent-%COMP%]{background-color:#212121}.fondo[_ngcontent-%COMP%]{background-image:url("./media/fondo-login-L6UNPQO5.jpg");background-size:cover;background-position:center center;background-repeat:no-repeat;height:90vh;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff}.centered-footer[_ngcontent-%COMP%]{display:flex;justify-content:center;text-align:center}']});let e=r;return e})();export{we as a};
